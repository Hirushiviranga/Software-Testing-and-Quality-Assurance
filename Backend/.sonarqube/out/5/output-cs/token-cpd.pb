œ
D:\QA1\Backend\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
builder 
. 
Services 
. 
AddControllers 
(  
)  !
;! "
builder 
. 
Services 
. 
AddCors 
( 
options  
=>! #
{ 
options   
.   
	AddPolicy   
(   
$str   %
,  % &
policy!! 
=>!! 
policy!! 
.!! 
AllowAnyOrigin!! '
(!!' (
)!!( )
."" 
AllowAnyMethod"" '
(""' (
)""( )
.## 
AllowAnyHeader## '
(##' (
)##( )
)##) *
;##* +
}$$ 
)$$ 
;$$ 
var&& 
app&& 
=&& 	
builder&&
 
.&& 
Build&& 
(&& 
)&& 
;&& 
if)) 
()) 
!)) 
app)) 
.)) 	
Environment))	 
.)) 
IsDevelopment)) "
())" #
)))# $
)))$ %
{** 
app++ 
.++ 
UseHsts++ 
(++ 
)++ 
;++ 
},, 
app-- 
.-- 
UseHttpsRedirection-- 
(-- 
)-- 
;-- 
app00 
.00 
UseCors00 
(00 
$str00 
)00 
;00 
app11 
.11 
UseAuthorization11 
(11 
)11 
;11 
app33 
.33 
MapControllers33 
(33 
)33 
;33 
app44 
.44 
Run44 
(44 
)44 	
;44	 
õ
.D:\QA1\Backend\Filters\APIKeyAuthAttributes.cs
public 
class 
ApiKeyAuthAttribute  
:! "
	Attribute# ,
,, - 
IAuthorizationFilter. B
{ 
private 
const 
string 
ApiKeyHeader %
=& '
$str( 3
;3 4
private 
const 
string 
ApiKeyValue $
=% &
$str' 6
;6 7
public		 

void		 
OnAuthorization		 
(		  &
AuthorizationFilterContext		  :
context		; B
)		B C
{

 
if 

( 
! 
context 
. 
HttpContext  
.  !
Request! (
.( )
Headers) 0
.0 1
TryGetValue1 <
(< =
ApiKeyHeader= I
,I J
outK N
varO R
extractedKeyS _
)_ `
)` a
{ 	
context 
. 
Result 
= 
new  
UnauthorizedResult! 3
(3 4
)4 5
;5 6
return 
; 
} 	
if 

( 
! 
ApiKeyValue 
. 
Equals 
(  
extractedKey  ,
), -
)- .
{ 	
context 
. 
Result 
= 
new  
UnauthorizedResult! 3
(3 4
)4 5
;5 6
} 	
} 
} Ð9
8D:\QA1\Backend\controller\CalculatorHistoryController.cs
	namespace 	
Backend
 
. 
Controllers 
{ 
public		 

class		 
ApiKeyAuthAttribute		 $
:		% &
	Attribute		' 0
,		0 1 
IAuthorizationFilter		2 F
{

 
private 
const 
string 
ApiKeyHeader )
=* +
$str, 7
;7 8
private 
const 
string 
ApiKeyValue (
=) *
$str+ :
;: ;
public 
void 
OnAuthorization #
(# $&
AuthorizationFilterContext$ >
context? F
)F G
{ 	
if 
( 
! 
context 
. 
HttpContext $
.$ %
Request% ,
., -
Headers- 4
.4 5
TryGetValue5 @
(@ A
ApiKeyHeaderA M
,M N
outO R
varS V
extractedApiKeyW f
)f g
)g h
{ 
context 
. 
Result 
=  
new! $
UnauthorizedResult% 7
(7 8
)8 9
;9 :
return 
; 
} 
if 
( 
! 
string 
. 
Equals 
( 
extractedApiKey .
,. /
ApiKeyValue0 ;
); <
)< =
{ 
context 
. 
Result 
=  
new! $
UnauthorizedResult% 7
(7 8
)8 9
;9 :
} 
} 	
} 
public 

class 
Calculation 
{ 
public   
int   
Id   
{   
get   
;   
set    
;    !
}  " #
public!! 
string!! 

Expression!!  
{!!! "
get!!# &
;!!& '
set!!( +
;!!+ ,
}!!- .
=!!/ 0
null!!1 5
!!!5 6
;!!6 7
public"" 
string"" 
Result"" 
{"" 
get"" "
;""" #
set""$ '
;""' (
}"") *
=""+ ,
null""- 1
!""1 2
;""2 3
}## 
[%% 
ApiController%% 
]%% 
[&& 
Route&& 

(&&
 
$str&& 
)&& 
]&& 
public'' 

class'' '
CalculatorHistoryController'' ,
:''- .
ControllerBase''/ =
{(( 
private)) 
static)) 
List)) 
<)) 
Calculation)) '
>))' (
_history))) 1
=))2 3
new))4 7
List))8 <
<))< =
Calculation))= H
>))H I
())I J
)))J K
;))K L
private** 
static** 
int** 
_nextId** "
=**# $
$num**% &
;**& '
[,, 	
HttpGet,,	 
],, 
public-- 
ActionResult-- 
<-- 
List--  
<--  !
Calculation--! ,
>--, -
>--- .

GetHistory--/ 9
(--9 :
)--: ;
{.. 	
return// 
Ok// 
(// 
_history// 
)// 
;//  
}00 	
[22 	
HttpPost22	 
]22 
[33 	

ApiKeyAuth33	 
]33 
public44 
ActionResult44 
<44 
Calculation44 '
>44' (
AddCalculation44) 7
(447 8
[448 9
FromBody449 A
]44A B
Calculation44C N
calc44O S
)44S T
{55 	
calc66 
.66 
Id66 
=66 
_nextId66 
++66 
;66  
_history77 
.77 
Add77 
(77 
calc77 
)77 
;77 
return88 
Ok88 
(88 
calc88 
)88 
;88 
}99 	
[;; 	
HttpPut;;	 
(;; 
$str;; 
);; 
];; 
[<< 	

ApiKeyAuth<<	 
]<< 
public== 
ActionResult== 
EditCalculation== +
(==+ ,
int==, /
id==0 2
,==2 3
[==4 5
FromBody==5 =
]=== >
Calculation==? J
calc==K O
)==O P
{>> 	
var?? 
existing?? 
=?? 
_history?? #
.??# $
FirstOrDefault??$ 2
(??2 3
c??3 4
=>??5 7
c??8 9
.??9 :
Id??: <
==??= ?
id??@ B
)??B C
;??C D
if@@ 
(@@ 
existing@@ 
==@@ 
null@@  
)@@  !
return@@" (
NotFound@@) 1
(@@1 2
)@@2 3
;@@3 4
existingBB 
.BB 

ExpressionBB 
=BB  !
calcBB" &
.BB& '

ExpressionBB' 1
;BB1 2
existingCC 
.CC 
ResultCC 
=CC 
calcCC "
.CC" #
ResultCC# )
;CC) *
returnDD 
OkDD 
(DD 
existingDD 
)DD 
;DD  
}EE 	
[GG 	

HttpDeleteGG	 
(GG 
$strGG 
)GG 
]GG 
[HH 	

ApiKeyAuthHH	 
]HH 
publicII 
ActionResultII 
DeleteCalculationII -
(II- .
intII. 1
idII2 4
)II4 5
{JJ 	
varKK 
existingKK 
=KK 
_historyKK #
.KK# $
FirstOrDefaultKK$ 2
(KK2 3
cKK3 4
=>KK5 7
cKK8 9
.KK9 :
IdKK: <
==KK= ?
idKK@ B
)KKB C
;KKC D
ifLL 
(LL 
existingLL 
==LL 
nullLL  
)LL  !
returnLL" (
NotFoundLL) 1
(LL1 2
)LL2 3
;LL3 4
_historyNN 
.NN 
RemoveNN 
(NN 
existingNN $
)NN$ %
;NN% &
returnOO 
OkOO 
(OO 
)OO 
;OO 
}PP 	
publicSS 
staticSS 
CalculationSS !
AddToHistorySS" .
(SS. /
stringSS/ 5

expressionSS6 @
,SS@ A
stringSSB H
resultSSI O
)SSO P
{TT 	
varUU 
calcUU 
=UU 
newUU 
CalculationUU &
{VV 
IdWW 
=WW 
_nextIdWW 
++WW 
,WW 

ExpressionXX 
=XX 

expressionXX '
,XX' (
ResultYY 
=YY 
resultYY 
}ZZ 
;ZZ 
_history[[ 
.[[ 
Add[[ 
([[ 
calc[[ 
)[[ 
;[[ 
return\\ 
calc\\ 
;\\ 
}]] 	
}^^ 
}__ è$
1D:\QA1\Backend\controller\CalculatorController.cs
	namespace 	
Backend
 
. 
Controllers 
{ 
[ 
ApiController 
] 
[ 
Route 

(
 
$str 
) 
] 
public		 

class		  
CalculatorController		 %
:		& '
ControllerBase		( 6
{

 
public  
CalculatorController #
(# $
)$ %
{& '
}( )
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
IActionResult 
Add  
(  !
int! $
a% &
,& '
int( +
b, -
)- .
{ 	
int 
result 
= 
a 
+ 
b 
; 
string 

expression 
= 
$"  "
{" #
a# $
}$ %
$str% (
{( )
b) *
}* +
"+ ,
;, -'
CalculatorHistoryController '
.' (
AddToHistory( 4
(4 5

expression5 ?
,? @
resultA G
.G H
ToStringH P
(P Q
)Q R
)R S
;S T
return 
Ok 
( 
result 
) 
; 
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
IActionResult 
Subtract %
(% &
int& )
a* +
,+ ,
int- 0
b1 2
)2 3
{ 	
int 
result 
= 
a 
- 
b 
; 
string 

expression 
= 
$"  "
{" #
a# $
}$ %
$str% (
{( )
b) *
}* +
"+ ,
;, -'
CalculatorHistoryController '
.' (
AddToHistory( 4
(4 5

expression5 ?
,? @
resultA G
.G H
ToStringH P
(P Q
)Q R
)R S
;S T
return 
Ok 
( 
result 
) 
; 
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public   
IActionResult   
Multiply   %
(  % &
int  & )
a  * +
,  + ,
int  - 0
b  1 2
)  2 3
{!! 	
int"" 
result"" 
="" 
a"" 
*"" 
b"" 
;"" 
string## 

expression## 
=## 
$"##  "
{##" #
a### $
}##$ %
$str##% (
{##( )
b##) *
}##* +
"##+ ,
;##, -'
CalculatorHistoryController$$ '
.$$' (
AddToHistory$$( 4
($$4 5

expression$$5 ?
,$$? @
result$$A G
.$$G H
ToString$$H P
($$P Q
)$$Q R
)$$R S
;$$S T
return%% 
Ok%% 
(%% 
result%% 
)%% 
;%% 
}&& 	
[(( 	
HttpGet((	 
((( 
$str(( 
)(( 
](( 
public)) 
IActionResult)) 
Divide)) #
())# $
int))$ '
a))( )
,))) *
int))+ .
b))/ 0
)))0 1
{** 	
if++ 
(++ 
b++ 
==++ 
$num++ 
)++ 
return,, 

BadRequest,, !
(,,! "
$str,," 9
),,9 :
;,,: ;
int.. 
result.. 
=.. 
a.. 
/.. 
b.. 
;.. 
string// 

expression// 
=// 
$"//  "
{//" #
a//# $
}//$ %
$str//% (
{//( )
b//) *
}//* +
"//+ ,
;//, -'
CalculatorHistoryController00 '
.00' (
AddToHistory00( 4
(004 5

expression005 ?
,00? @
result00A G
.00G H
ToString00H P
(00P Q
)00Q R
)00R S
;00S T
return11 
Ok11 
(11 
result11 
)11 
;11 
}22 	
}33 
}44 